<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="Calculator App" Language="1033"
           Version="1.0.0.0" Manufacturer="YourName"
           UpgradeCode="A6B2F1D0-7C4E-4B9A-9F01-123456789ABC">

    <!-- per-machine installer -->
    <Package InstallerVersion="300" Compressed="yes" InstallScope="perMachine" />

    <!-- UI + InstallDir property -->
    <UIRef Id="WixUI_Mondo"/>
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER"/>

    <!-- Media -->
    <Media Id="1" Cabinet="cab1.cab" EmbedCab="yes"/>

    <!-- Icon for shortcuts and ARP (Calc.ico must be in installer/) -->
    <Icon Id="AppIcon" SourceFile="Calc.ico"/>
    <Property Id="ARPPRODUCTICON" Value="AppIcon"/>

    <!-- Directory tree -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="CalculatorApp"/>
      </Directory>

      <!-- Program menu and desktop are logical Windows Installer folders -->
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ProgramMenuDir" Name="Calculator App"/>
      </Directory>

      <Directory Id="DesktopFolder"/>
    </Directory>

    <!-- Main application files -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="AppFilesComponent" Guid="E1111111-1111-1111-1111-111111111111">
        <File Id="IndexHtml" Source="../index.html" KeyPath="yes" />
        <File Id="ScriptJs"  Source="../script.js" />
        <File Id="StyleCss"  Source="../style.css" />
      </Component>
    </DirectoryRef>

    <!-- Start Menu shortcut component (per-user KeyPath in HKCU) -->
    <DirectoryRef Id="ProgramMenuDir">
      <Component Id="StartMenuShortcutComponent" Guid="E2222222-2222-2222-2222-222222222222">
        <Shortcut Id="StartMenuShortcut"
                  Directory="ProgramMenuDir"
                  Name="Calculator App"
                  Description="Open Calculator App"
                  Target="[INSTALLFOLDER]index.html"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon" />
        <!-- Use HKCU registry key as KeyPath because shortcut is in user scope -->
        <RegistryValue Root="HKCU"
                       Key="Software\CalculatorApp\Shortcuts"
                       Name="StartMenu"
                       Type="string"
                       Value="1"
                       KeyPath="yes"/>
        <RemoveFolder Id="RemoveProgramMenuDir" Directory="ProgramMenuDir" On="uninstall"/>
      </Component>
    </DirectoryRef>

    <!-- Desktop shortcut component (per-user KeyPath in HKCU) -->
    <DirectoryRef Id="DesktopFolder">
      <Component Id="DesktopShortcutComponent" Guid="E3333333-3333-3333-3333-333333333333">
        <Shortcut Id="DesktopShortcut"
                  Directory="DesktopFolder"
                  Name="Calculator App"
                  Description="Open Calculator App"
                  Target="[INSTALLFOLDER]index.html"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="AppIcon" />
        <RegistryValue Root="HKCU"
                       Key="Software\CalculatorApp\Shortcuts"
                       Name="Desktop"
                       Type="string"
                       Value="1"
                       KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <!-- Features -->
    <Feature Id="MainFeature" Title="Calculator App" Level="1">
      <ComponentRef Id="AppFilesComponent" />
    </Feature>

    <Feature Id="StartMenuFeature" Title="Start Menu shortcut" Level="1" Absent="allow">
      <ComponentRef Id="StartMenuShortcutComponent" />
    </Feature>

    <Feature Id="DesktopFeature" Title="Desktop shortcut" Level="1" Absent="allow">
      <ComponentRef Id="DesktopShortcutComponent" />
    </Feature>

  </Product>
</Wix>
